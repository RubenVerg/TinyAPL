module TinyAPL.Keymaps where

import Data.List

keymapIndexOf :: String -> Maybe Int
keymapIndexOf keymap = elemIndex keymap existingKeymaps

singleChars :: Int -> [(Char, Char)]
singleChars keymapIndex = map (\line -> (line !! (1+keymapIndex), head line)) singleCharacters

doubleChars :: Int -> [(Char, Char)]
doubleChars keymapIndex = map (\line -> (line !! (1+keymapIndex), head line)) doubleCharacters
  
existingKeymaps :: [String]
existingKeymaps = ["us-intl", "es-ca"]

n :: Char -- For when the character isn't needed in the keymap
n = '�'   -- Untypable key

singleCharacters :: [[Char]]
singleCharacters =
  [ ['¨', '1', n]
  , ['¯', '2', '2']
  , ['˝', '3', '3']
  , ['≤', '4', '4']
  , ['⬚', '5', '5']
  , ['≥', '6', '6']
  , ['⌽', '7', '7']
  , ['≠', '8', '8']
  , ['∨', '9', '9']
  , ['∧', '0', '0']
  , ['×', '-', '\'']
  , ['÷', '=', '¡']
  , ['↗', 'q', 'q']
  , ['⍵', 'w', 'w']
  , ['∊', 'e', 'e']
  , ['⍴', 'r', 'r']
  , ['⊞', 't', 't']
  , ['↑', 'y', 'y']
  , ['↓', 'u', 'u']
  , ['⍳', 'i', 'i']
  , ['○', 'o', 'o']
  , ['◡', 'p', 'p']
  , ['←', '[', '`']
  , ['→', ']', '+']
  , ['⍺', 'a', 'a']
  , ['⌈', 's', 's']
  , ['⌊', 'd', 'd']
  , ['⍛', 'f', 'f']
  , ['∇', 'g', 'g']
  , ['∆', 'h', 'h']
  , ['∘', 'j', 'j']
  , ['⎊', 'k', 'k']
  , ['⎕', 'l', 'l']
  , ['⍎', ';', 'ñ']
  , ['⍕', '\'', '´']
  , ['⊢', '\\', 'ç']
  , ['⊂', 'z', 'z']
  , ['⊃', 'x', 'x']
  , ['∩', 'c', 'c']
  , ['∪', 'v', 'v']
  , ['⊥', 'b', 'b']
  , ['⊤', 'n', 'n']
  , ['«', 'm', 'm']
  , ['⍪', ',', ',']
  , ['∙', '.', '.']
  , ['⌿', '/', '-']
  , ['‿', ' ', ' ']
  
  , ['⍨', '~', 'ª']
  , ['⨳', '!', '!']
--, [' ', '@', '"']
  , ['⍒', '#', '·']
  , ['⍋', '$', '$']
  , ['≈', '%', '%']
  , ['⍉', '^', '&']
--, [' ', '&', '/']
  , ['⍣', '*', '(']
  , ['⍱', '(', ')']
  , ['⍲', ')', '=']
  , ['⊗', '_', '?']
  , ['⊕', '+', '¿']
--, [' ', 'Q', 'Q']
  , ['⍹', 'W', 'W']
  , ['⍷', 'E', 'E']
  , ['√', 'R', 'R']
  , ['⍨', 'T', 'T']
  , ['↟', 'Y', 'Y']
  , ['↡', 'U', 'U']
  , ['⍸', 'I', 'I']
  , ['⍥', 'O', 'O']
  , ['◠', 'P', 'P']
  , ['⟨', '{', '{']
  , ['⟩', '}', '}']
  , ['⍶', 'A', 'A']
  , ['§', 'S', 'S']
  , ['⸠', 'D', 'D']
  , ['∡', 'F', 'F']
  , ['⍢', 'G', 'G']
  , ['⍙', 'H', 'H']
  , ['⍤', 'J', 'J']
  , ['⌸', 'K', 'K']
  , ['⌷', 'L', 'L']
  , ['≡', ':', ':']
  , ['≢', '"', '"']
  , ['⊣', '|', '|']
  , ['⊆', 'Z', 'Z']
  , ['⊇', 'X', 'X']
  , ['⍝', 'C', 'C']
  , ['⁖', 'V', 'V']
  , ['∵', 'B', 'B']
  , ['·', 'N', 'N']
  , ['»', 'M', 'M']
  , ['ᑈ', '<', '<']
  , ['ᐵ', '>', '>']
--, [' ', '?', '?']
  ]

doubleCharacters :: [[Char]]
doubleCharacters =
  [ ['⋄', '`', 'º']
--, [' ', '1', '1']
--, [' ', '2', '2']
--, [' ', '3', '3']
  , ['⊴', '4', '4']
  , ['⤺', '5', '5']
  , ['⊵', '6', '6']
--, [' ', '7', '7']
  , ['⍟', '8', '8']
  , ['∻', '9', '9']
  , ['⍬', '0', '0']
  , ['⸚', '-', '\'']
  , ['⌹', '=', '¡']
  , ['⇾', 'q', 'q']
--, [' ', 'w', 'w']
  , ['⋵', 'e', 'e']
  , ['ϼ', 'r', 'r']
  , ['߹', 't', 't']
  , ['ᓚ', 'y', 'y']
  , ['ᓗ', 'u', 'u']
  , ['…', 'i', 'i']
  , ['⍜', 'o', 'o']
  , ['⏨', 'p', 'p']
  , ['⦅', '[', '[']
  , ['⦆', ']', ']']
  , ['ɛ', 'a', 'a']
  , ['↾', 's', 's']
  , ['⇂', 'd', 'd']
  , ['∠', 'f', 'f']
  , ['⫇', 'g', 'g']
  , ['⊸', 'h', 'h']
  , ['ᴊ', 'j', 'j']
--, [' ', 'k', 'k']
--, [' ', 'l', 'l']
  , ['⍮', ';', 'ñ']
  , ['⍘', '\'', '´']
  , ['⊩', '\\', 'ç']
  , ['⊏', 'z', 'z']
  , ['⊐', 'x', 'x']
  , ['⟃', 'c', 'c']
  , ['⫤', 'v', 'v']
  , ['⇇', 'b', 'b']
  , ['↚', 'n', 'n']
  , ['↩', 'm', 'm']
  , ['⊲', ',', ',']
  , ['⊳', '.', '.']
--, [' ', '/', '-']
  , ['`', ' ', n]
 
  , ['⌺', '~', 'ª']
  , ['⑴', '!', '!']
--, [' ', '@', '"']
--, [' ', '#', '·']
--, [' ', '$', '$']
--, [' ', '%', '%']
--, [' ', '^', '&']
--, [' ', '&', '/']
  , ['∞', '*', '(']
  , ['⦋', '(', ')']
  , ['⦌', ')', '=']
  , ['ⵧ', '_', '?']
  , ['⧺', '+', '¿']
  , ['⇽', 'Q', 'Q']
--, [' ', 'W', 'W']
  , ['⋷', 'E', 'E']
  , ['ℜ', 'R', 'R']
  , ['‥', 'T', 'T']
  , ['⥽', 'Y', 'Y']
  , ['⥼', 'U', 'U']
  , ['ℑ', 'I', 'I']
--, [' ', 'O', 'O']
  , ['⌓', 'P', 'P']
  , ['⦃', '{', '{']
  , ['⦄', '}', '}']
--, [' ', 'A', 'A']
--, [' ', 'S', 'S']
  , ['⩔', 'D', 'D']
--, [' ', 'F', 'F']
--, [' ', 'G', 'G']
  , ['⟜', 'H', 'H']
--, [' ', 'J', 'J']
--, [' ', 'K', 'K']
--, [' ', 'L', 'L']
  , ['⍠', ':', 'Ñ']
  , ['⍞', '"', '¨']
  , ['⫣', '|', 'Ç']
  , ['ᑣ', 'Z', 'Z']
  , ['ᑒ', 'X', 'X']
  , ['⟄', 'C', 'C']
--, [' ', 'V', 'V']
--, [' ', 'B', 'B']
  , ['⩓', 'N', 'N']
  , ['⍦', 'M', 'M']
--, [' ', '<', ';']
  , ['■', '>', ':']
  , ['⍰', '?', '_']
  ]
