module TinyAPL.Keymaps where

import Control.Arrow
import Data.Maybe
import Data.List
import qualified Data.Map as Map

data Keymap = UsIntl | EsCa deriving (Show, Eq, Enum)

existingKeymaps :: [Keymap]
existingKeymaps = [UsIntl ..]

singleChars :: Keymap -> [(Char, Char)]
singleChars idx = Map.fromList[(USIntl, keymapUsIntl)]

doubleChars :: Keymap -> [(Char, Char)]
doubleChars idx = map (flip (!!) (1+idx) &&& fromJust . listToMaybe) doubleCharacters
  
keymapUsIntl :: ([(Char, Char)],[(Char, Char)])
keymapUsIntl =
  (
  [ ('~', '⍨')
  , ('1', '¨'), ('2', '¯'), ('4', '≤'), ('3', '˝'), ('5', '⬚'), ('6', '≥'), ('7', '⌽'), ('8', '≠'), ('9', '∨'), ('0', '∧'), ('-', '×'), ('=', '÷')
  , ('q', '↗'), ('w', '⍵'), ('e', '∊'), ('r', '⍴'), ('t', '⊞'), ('y', '↑'), ('u', '↓'), ('i', '⍳'), ('o', '○'), ('p', '◡'), ('[', '←'), (']', '→')
  , ('a', '⍺'), ('s', '⌈'), ('d', '⌊'), ('f', '⍛'), ('g', '∇'), ('h', '∆'), ('j', '∘'), ('k', '⎊'), ('l', '⎕'), (';', '⍎'), ('\'', '⍕'), ('\\', '⊢')
  , ('z', '⊂'), ('x', '⊃'), ('c', '∩'), ('v', '∪'), ('b', '⊥'), ('n', '⊤'), ('m', '«'), (',', '⍪'), ('.', '∙'), ('/', '⌿'),
    (' ', '‿'), 
  , ('!', '⨳'){-,('@', )-}, ('#', '⍒'), ('$', '⍋'), ('%', '≈'), ('^', '⍉'),{-('&','')-} ('*', '⍣'), ('(', '⍱'), (')', '⍲'), ('_', '⊗'), ('+', '⊕')
  ,{-('Q','')-} ('W', '⍹'), ('E', '⍷'), ('R', '√'), ('T', '⍨'), ('Y', '↟'), ('U', '↡'), ('I', '⍸'), ('O', '⍥'), ('P', '◠'), ('{', '⟨'), ('}', '⟩')
  , ('A', '⍶'), ('S', '§'), ('D', '⸠'), ('F', '∡'), ('G', '⍢'), ('H', '⍙'), ('J', '⍤'), ('K', '⌸'), ('L', '⌷'), (':', '≡'), ('"', '≢'), ('|', '⊣')
  , ('Z', '⊆'), ('X', '⊇'), ('C', '⍝'), ('V', '⁖'), ('B', '∵'), ('N', '·'), ('M', '»'), ('<', 'ᑈ'), ('>', 'ᐵ') {-('?','')-}
  ],
  [ ('`', '⋄')
   {-('1', ''), ('2', ''), ('3', '')-}, ('4', '⊴'), ('5', '⤺'), ('6', '⊵'){-,('7','')-}, ('8', '⍟'), ('9', '∻'), ('0', '⍬'), ('-', '⸚'), ('=', '⌹')
  , ('q', '⇾'){-('w','')-}, ('e', '⋵'), ('r', 'ϼ'), ('t', '߹'), ('y', 'ᓚ'), ('u', 'ᓗ'), ('i', '…'), ('o', '⍜'), ('p', '⏨'), ('[', '⦅'), (']', '⦆')
  , ('a', 'ɛ'), ('s', '↾'), ('d', '⇂'), ('f', '∠'), ('g', '⫇'), ('h', '⊸'), ('j', 'ᴊ'){-('k', ' '), ('l', ' '), (';', '⍮'), ('\'', '⍘'), ('\\', '⊩')-}
  , ('z', '⊏'), ('x', '⊐'), ('c', '⟃'), ('v', '⫤'), ('b', '⇇'), ('n', '↚'), ('m', '↩'), (',', '⊲'), ('.', '⊳'){-('/','')-}
  , (' ', '`'), ('~', '⌺'), ('!', '⑴'){-('@', ' '), ('#', ' '), ('$', ' '), ('%', ' '), ('^', ' '),('&', '')-}, ('*', '∞'), ('(', '⦋'), (')', '⦌'), ('_', 'ⵧ'), ('+', '⧺')
  , ('Q', '⇽')
--, ('W', ' ')
  , ('E', '⋷') , ('R', 'ℜ') , ('T', '‥') , ('Y', '⥽') , ('U', '⥼') , ('I', 'ℑ')
--, ('O', ' ')
  , ('P', '⌓')
  , ('{', '⦃')
  , ('}', '⦄')
--, ('A', ' ')
--, ('S', ' ')
  , ('D', '⩔')
--, ('F', ' ')
--, ('G', ' ')
  , ('H', '⟜')
--, ('J', ' ')
--, ('K', ' ')
--, ('L', ' ')
  , (':', '⍠')
  , ('"', '⍞')
  , ('|', '⫣')
  , ('Z', 'ᑣ')
  , ('X', 'ᑒ')
  , ('C', '⟄')
--, ('V', ' ')
--, ('B', ' ')
  , ('N', '⩓')
  , ('M', '⍦')
--, ('<', ' ')
  , ('>', '■')
  , ('?', '⍰')
  ]


  

singleCharacters :: [[Char]]
singleCharacters =
  [ ['¨', '1', nop]
  , ['¯', '2', '2']
  , ['˝', '3', '3']
  , ['≤', '4', '4']
  , ['⬚', '5', '5']
  , ['≥', '6', '6']
  , ['⌽', '7', '7']
  , ['≠', '8', '8']
  , ['∨', '9', '9']
  , ['∧', '0', '0']
  , ['×', '-', '\'']
  , ['÷', '=', '¡']
  , ['↗', 'q', 'q']
  , ['⍵', 'w', 'w']
  , ['∊', 'e', 'e']
  , ['⍴', 'r', 'r']
  , ['⊞', 't', 't']
  , ['↑', 'y', 'y']
  , ['↓', 'u', 'u']
  , ['⍳', 'i', 'i']
  , ['○', 'o', 'o']
  , ['◡', 'p', 'p']
  , ['←', '[', '`']
  , ['→', ']', '+']
  , ['⍺', 'a', 'a']
  , ['⌈', 's', 's']
  , ['⌊', 'd', 'd']
  , ['⍛', 'f', 'f']
  , ['∇', 'g', 'g']
  , ['∆', 'h', 'h']
  , ['∘', 'j', 'j']
  , ['⎊', 'k', 'k']
  , ['⎕', 'l', 'l']
  , ['⍎', ';', 'ñ']
  , ['⍕', '\'', '´']
  , ['⊢', '\\', 'ç']
  , ['⊂', 'z', 'z']
  , ['⊃', 'x', 'x']
  , ['∩', 'c', 'c']
  , ['∪', 'v', 'v']
  , ['⊥', 'b', 'b']
  , ['⊤', 'n', 'n']
  , ['«', 'm', 'm']
  , ['⍪', ',', ',']
  , ['∙', '.', '.']
  , ['⌿', '/', '-']
  , ['‿', ' ', ' ']
  
  , ['⍨', '~', 'ª']
  , ['⨳', '!', '!']
--, [' ', '@', '"']
  , ['⍒', '#', '·']
  , ['⍋', '$', '$']
  , ['≈', '%', '%']
  , ['⍉', '^', '&']
--, [' ', '&', '/']
  , ['⍣', '*', '(']
  , ['⍱', '(', ')']
  , ['⍲', ')', '=']
  , ['⊗', '_', '?']
  , ['⊕', '+', '¿']
--, [' ', 'Q', 'Q']
  , ['⍹', 'W', 'W']
  , ['⍷', 'E', 'E']
  , ['√', 'R', 'R']
  , ['⍨', 'T', 'T']
  , ['↟', 'Y', 'Y']
  , ['↡', 'U', 'U']
  , ['⍸', 'I', 'I']
  , ['⍥', 'O', 'O']
  , ['◠', 'P', 'P']
  , ['⟨', '{', '{']
  , ['⟩', '}', '}']
  , ['⍶', 'A', 'A']
  , ['§', 'S', 'S']
  , ['⸠', 'D', 'D']
  , ['∡', 'F', 'F']
  , ['⍢', 'G', 'G']
  , ['⍙', 'H', 'H']
  , ['⍤', 'J', 'J']
  , ['⌸', 'K', 'K']
  , ['⌷', 'L', 'L']
  , ['≡', ':', ':']
  , ['≢', '"', '"']
  , ['⊣', '|', '|']
  , ['⊆', 'Z', 'Z']
  , ['⊇', 'X', 'X']
  , ['⍝', 'C', 'C']
  , ['⁖', 'V', 'V']
  , ['∵', 'B', 'B']
  , ['·', 'N', 'N']
  , ['»', 'M', 'M']
  , ['ᑈ', '<', '<']
  , ['ᐵ', '>', '>']
--, [' ', '?', '?']
  ]

doubleCharacters :: [[Char]]
doubleCharacters =
  [ ['⋄', '`', 'º']
--, [' ', '1', '1']
--, [' ', '2', '2']
--, [' ', '3', '3']
  , ['⊴', '4', '4']
  , ['⤺', '5', '5']
  , ['⊵', '6', '6']
--, [' ', '7', '7']
  , ['⍟', '8', '8']
  , ['∻', '9', '9']
  , ['⍬', '0', '0']
  , ['⸚', '-', '\'']
  , ['⌹', '=', '¡']
  , ['⇾', 'q', 'q']
--, [' ', 'w', 'w']
  , ['⋵', 'e', 'e']
  , ['ϼ', 'r', 'r']
  , ['߹', 't', 't']
  , ['ᓚ', 'y', 'y']
  , ['ᓗ', 'u', 'u']
  , ['…', 'i', 'i']
  , ['⍜', 'o', 'o']
  , ['⏨', 'p', 'p']
  , ['⦅', '[', '[']
  , ['⦆', ']', ']']
  , ['ɛ', 'a', 'a']
  , ['↾', 's', 's']
  , ['⇂', 'd', 'd']
  , ['∠', 'f', 'f']
  , ['⫇', 'g', 'g']
  , ['⊸', 'h', 'h']
  , ['ᴊ', 'j', 'j']
--, [' ', 'k', 'k']
--, [' ', 'l', 'l']
  , ['⍮', ';', 'ñ']
  , ['⍘', '\'', '´']
  , ['⊩', '\\', 'ç']
  , ['⊏', 'z', 'z']
  , ['⊐', 'x', 'x']
  , ['⟃', 'c', 'c']
  , ['⫤', 'v', 'v']
  , ['⇇', 'b', 'b']
  , ['↚', 'n', 'n']
  , ['↩', 'm', 'm']
  , ['⊲', ',', ',']
  , ['⊳', '.', '.']
--, [' ', '/', '-']
  , ['`', ' ', nop]
 
  , ['⌺', '~', 'ª']
  , ['⑴', '!', '!']
--, [' ', '@', '"']
--, [' ', '#', '·']
--, [' ', '$', '$']
--, [' ', '%', '%']
--, [' ', '^', '&']
--, [' ', '&', '/']
  , ['∞', '*', '(']
  , ['⦋', '(', ')']
  , ['⦌', ')', '=']
  , ['ⵧ', '_', '?']
  , ['⧺', '+', '¿']
  , ['⇽', 'Q', 'Q']
--, [' ', 'W', 'W']
  , ['⋷', 'E', 'E']
  , ['ℜ', 'R', 'R']
  , ['‥', 'T', 'T']
  , ['⥽', 'Y', 'Y']
  , ['⥼', 'U', 'U']
  , ['ℑ', 'I', 'I']
--, [' ', 'O', 'O']
  , ['⌓', 'P', 'P']
  , ['⦃', '{', '{']
  , ['⦄', '}', '}']
--, [' ', 'A', 'A']
--, [' ', 'S', 'S']
  , ['⩔', 'D', 'D']
--, [' ', 'F', 'F']
--, [' ', 'G', 'G']
  , ['⟜', 'H', 'H']
--, [' ', 'J', 'J']
--, [' ', 'K', 'K']
--, [' ', 'L', 'L']
  , ['⍠', ':', 'Ñ']
  , ['⍞', '"', '¨']
  , ['⫣', '|', 'Ç']
  , ['ᑣ', 'Z', 'Z']
  , ['ᑒ', 'X', 'X']
  , ['⟄', 'C', 'C']
--, [' ', 'V', 'V']
--, [' ', 'B', 'B']
  , ['⩓', 'N', 'N']
  , ['⍦', 'M', 'M']
--, [' ', '<', ';']
  , ['■', '>', ':']
  , ['⍰', '?', '_']
  ]
